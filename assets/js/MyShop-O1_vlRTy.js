import{e,j as s,d as a}from"./index-jHmpFEMT.js";import{r}from"./vendor-CyyySG0f.js";import{C as t,a as l,b as d,B as i,c,d as n}from"./card-CmKHpVHl.js";import{m,l as o,x}from"./firebase-rYhY7HPw.js";import{L as h,I as p}from"./label-DM97D0RX.js";import{P as u}from"./PostalCodeAutocomplete-DBHDLA_4.js";import{X as j,U as N,P as f,a as y,b as g,c as b,C as v,D as w}from"./ui-D10HkiTw.js";import{m as C}from"./m1-DUCQGgOG.js";import{u as z}from"./router-Dpy7eVzN.js";const D=({isOpen:a,onClose:g,userId:b,userEmail:v})=>{const[w,C]=r.useState({name:"",phone:"",address:"",zipcode:""}),[z,D]=r.useState(!1),[P,S]=r.useState(""),[E,U]=r.useState("");r.useEffect(()=>{a&&k()},[a]);const k=async()=>{try{const s=await m(o(e,"users",b));if(s.exists()){const e=s.data();C({name:e.displayName||"",phone:e.phone||"",address:e.address||"",zipcode:e.zipcode||""})}}catch(s){}},q=(e,s)=>{C(a=>({...a,[e]:s}))};return a?s.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:s.jsxs(t,{className:"w-full max-w-md",children:[s.jsxs(l,{className:"text-center",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx(d,{className:"text-2xl font-bold",children:"Edit Profile"}),s.jsx(i,{variant:"ghost",size:"sm",onClick:g,children:s.jsx(j,{className:"h-5 w-5"})})]}),s.jsx(c,{children:"Update your profile information"})]}),s.jsxs(n,{children:[E&&s.jsx("div",{className:"mb-4 p-3 bg-green-100 border border-green-300 text-green-700 rounded-md text-sm",children:E}),P&&s.jsx("div",{className:"mb-4 p-3 bg-red-100 border border-red-300 text-red-700 rounded-md text-sm",children:P}),s.jsxs("div",{className:"mb-4 p-3 bg-blue-50 border border-blue-200 text-blue-700 rounded-md text-sm",children:[s.jsx("strong",{children:"Email:"})," ",v]}),s.jsxs("form",{onSubmit:async s=>{if(s.preventDefault(),w.name.trim()&&w.phone.trim()&&w.address.trim()&&w.zipcode.trim())try{D(!0),S("");const s=o(e,"users",b);await x(s,{displayName:w.name,phone:w.phone,address:w.address,zipcode:w.zipcode,profileComplete:!0,profileUpdatedAt:new Date}),U("Profile updated successfully!"),setTimeout(()=>{g(),U("")},2e3)}catch(a){S("Failed to update profile. Please try again.")}finally{D(!1)}else S("Please fill in all fields")},className:"space-y-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(h,{htmlFor:"edit-name",children:"Full Name *"}),s.jsxs("div",{className:"relative",children:[s.jsx(N,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),s.jsx(p,{id:"edit-name",type:"text",placeholder:"Enter your full name",value:w.name,onChange:e=>q("name",e.target.value),className:"pl-10",required:!0})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(h,{htmlFor:"edit-phone",children:"Phone Number *"}),s.jsxs("div",{className:"relative",children:[s.jsx(f,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),s.jsx(p,{id:"edit-phone",type:"tel",placeholder:"Enter your phone number",value:w.phone,onChange:e=>(e=>{const s=e.replace(/\D/g,"");C(e=>({...e,phone:s}))})(e.target.value),className:"pl-10",required:!0})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(h,{htmlFor:"edit-address",children:"Address *"}),s.jsxs("div",{className:"relative",children:[s.jsx(y,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),s.jsx(p,{id:"edit-address",type:"text",placeholder:"Enter your full address",value:w.address,onChange:e=>q("address",e.target.value),className:"pl-10",required:!0})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(h,{htmlFor:"edit-zipcode",children:"Zipcode *"}),s.jsx(u,{value:w.zipcode,onChange:e=>q("zipcode",e),placeholder:"Enter zip code or suburb name",required:!0,onSuggestionSelect:e=>{}})]}),s.jsx(i,{type:"submit",disabled:z,className:"w-full",children:z?s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Updating Profile..."]}):"Update Profile"})]})]})]})}):null},P=()=>{const x=z(),[h,p]=r.useState(null),[u,j]=r.useState([]),[f,y]=r.useState(!1);r.useEffect(()=>{a.currentUser?(P(),S()):x("/")},[x]);const P=async()=>{try{const s=await m(o(e,"users",a.currentUser.uid));if(s.exists()){const e=s.data();p(e)}}catch(s){}},S=async()=>{try{j([{id:"1",productName:"Milaf Cola Classic",quantity:2,price:4.99,orderDate:new Date("2024-01-15"),status:"Delivered"},{id:"2",productName:"Milaf Cola Zero",quantity:1,price:4.99,orderDate:new Date("2024-01-10"),status:"In Transit"}])}catch(e){}};return a.currentUser?s.jsxs("div",{className:"min-h-screen bg-cover bg-center bg-no-repeat",style:{backgroundImage:`url(${C})`},children:[s.jsx("div",{className:"bg-white/90 backdrop-blur-sm shadow-sm border-b border-gray-200",children:s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:s.jsxs("div",{className:"flex items-center justify-between h-16",children:[s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsx(i,{variant:"ghost",onClick:()=>{x("/")},className:"text-gray-600 hover:text-gray-900",children:"‚Üê Back to Home"}),s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"My Orders"})]}),s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsxs("div",{className:"text-right mr-3",children:[s.jsx("div",{className:"text-sm font-medium text-gray-900",children:h?.displayName||"User"}),s.jsx("div",{className:"text-xs text-gray-500",children:h?.address?(E=h.address,E.length<=15?E:E.substring(0,15)+"..."):"Address not provided"})]}),s.jsxs(i,{onClick:()=>y(!0),variant:"outline",size:"sm",className:"flex items-center space-x-2",children:[s.jsx(N,{className:"h-4 w-4"}),s.jsx("span",{children:"Profile"}),s.jsx(g,{className:"h-4 w-4"})]})]})]})})}),s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:s.jsx("div",{className:"space-y-6",children:s.jsxs(t,{className:"bg-white/95 backdrop-blur-sm",children:[s.jsxs(l,{children:[s.jsx(d,{children:"Your Orders"}),s.jsx(c,{children:"Track your orders and view their current status"})]}),s.jsx(n,{children:0===u.length?s.jsxs("div",{className:"text-center py-8 text-gray-500",children:[s.jsx(b,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),s.jsx("p",{children:"No orders yet"}),s.jsx("p",{className:"text-sm",children:"Place your first order to see it here"})]}):s.jsx("div",{className:"space-y-4",children:u.map(e=>s.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 bg-white/80",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(b,{className:"h-5 w-5 text-blue-600"}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-medium text-gray-900",children:e.productName}),s.jsxs("p",{className:"text-sm text-gray-500",children:["Order #",e.id]})]})]}),s.jsx("span",{className:"px-3 py-1 rounded-full text-xs font-medium "+("Delivered"===e.status?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"),children:e.status})]}),s.jsxs("div",{className:"grid grid-cols-3 gap-4 text-sm",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(v,{className:"h-4 w-4 text-gray-400"}),s.jsx("span",{className:"text-gray-600",children:e.orderDate.toLocaleDateString()})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("span",{className:"text-gray-400",children:"Qty:"}),s.jsx("span",{className:"text-gray-600",children:e.quantity})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(w,{className:"h-4 w-4 text-gray-400"}),s.jsxs("span",{className:"text-gray-600 font-medium",children:["$",(e.price*e.quantity).toFixed(2)]})]})]})]},e.id))})})]})})}),s.jsx(D,{isOpen:f,onClose:()=>{y(!1),P()},userId:a.currentUser.uid,userEmail:h?.email||""})]}):null;var E};export{P as MyShop};
