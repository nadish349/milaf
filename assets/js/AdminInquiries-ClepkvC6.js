import{j as e,e as s}from"./index-jHmpFEMT.js";import{r as a}from"./vendor-CyyySG0f.js";import{g as r,m as i}from"./inquiryFetch-mdR6qjWO.js";import{B as t,C as l,a as d,b as n,d as c}from"./card-CmKHpVHl.js";import{B as m}from"./badge-BCeezdQg.js";import{n as x,q as h,B as o,D as j}from"./firebase-rYhY7HPw.js";import{d as g,U as u,E as N,M as p,P as y,C as f,a as b}from"./ui-D10HkiTw.js";import"./router-Dpy7eVzN.js";const v=()=>{const[v,w]=a.useState([]),[q,S]=a.useState(!0),[A,k]=a.useState(null),[B,C]=a.useState(null),[E,I]=a.useState("");a.useEffect(()=>{let e;return(async()=>{e=await U()})(),()=>{e&&e()}},[]);const U=async()=>{try{S(!0),k(null);const e=r();I(e);const a=x(s,"inquiry",e,"inquiries"),i=h(a,o("createdAt","desc")),t=j(i,s=>{const a=[];s.forEach(s=>{const r=s.data();a.push({id:s.id,month:e,...r})}),w(a),S(!1)},e=>{k("Failed to load inquiries in real-time"),S(!1)});return()=>t()}catch(e){k(e instanceof Error?e.message:"Failed to load inquiries"),S(!1)}},z=e=>{if(!e)return"Unknown date";try{return e.toDate().toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return"Invalid date"}},D=v.filter(e=>!e.read),F=D.length,M=v.length;return q?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-2",children:"Business Inquiries"}),e.jsx("p",{className:"text-gray-600",children:"Loading inquiries..."})]}),e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("div",{className:"w-8 h-8 border-4 border-green-500 border-t-transparent rounded-full animate-spin"})})]}):A?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-2",children:"Business Inquiries"}),e.jsx("p",{className:"text-gray-600",children:"Error loading inquiries"})]}),e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6",children:[e.jsx("p",{className:"text-red-600",children:A}),e.jsx(t,{onClick:U,className:"mt-4",children:"Try Again"})]})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-white rounded-xl shadow-lg p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-2",children:"Business Inquiries"}),e.jsxs("p",{className:"text-gray-600",children:[F," unread inquiries from ",E," â€¢ ",M," total"]}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Showing only unread inquiries (read inquiries are hidden)"})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(t,{onClick:U,variant:"outline",size:"sm",children:"ðŸ”„ Refresh"})})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-1",children:e.jsxs(l,{children:[e.jsx(d,{children:e.jsxs(n,{className:"flex items-center gap-2",children:[e.jsx(g,{className:"w-5 h-5"}),"Unread Inquiries (",E,")",F>0&&e.jsx("div",{className:"w-3 h-3 bg-red-500 rounded-full animate-pulse"})]})}),e.jsx(c,{children:0===D.length?e.jsx("p",{className:"text-gray-500 text-center py-8",children:0===v.length?`No inquiries found for ${E}`:"No unread inquiries (all have been read)"}):e.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:D.map(s=>e.jsx("div",{className:"p-4 border rounded-lg cursor-pointer transition-all hover:shadow-md "+(B?.id===s.id?"border-green-500 bg-green-50":s.read?"border-gray-200 bg-white":"border-blue-500 bg-blue-50"),onClick:()=>C(s),children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h3",{className:"font-semibold text-gray-800",children:s.name}),!s.read&&e.jsx(m,{variant:"secondary",className:"bg-blue-100 text-blue-800",children:"New"})]}),e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:s.inquiryAbout}),e.jsx("p",{className:"text-xs text-gray-500",children:z(s.createdAt)})]}),e.jsx("div",{className:"text-right",children:e.jsx(m,{variant:"outline",className:"text-xs",children:s.month})})]})},`${s.month}-${s.id}`))})})]})}),e.jsx("div",{className:"lg:col-span-2",children:B?e.jsxs(l,{children:[e.jsx(d,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(n,{className:"flex items-center gap-2",children:[e.jsx(u,{className:"w-5 h-5"}),B.name]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(m,{variant:"outline",children:B.inquiryAbout}),!B.read&&e.jsxs(t,{size:"sm",onClick:()=>(async e=>{try{await i(e.month,e.id),w(s=>s.map(s=>s.id===e.id?{...s,read:!0}:s)),B?.id===e.id&&C({...e,read:!0})}catch(s){}})(B),className:"bg-green-600 hover:bg-green-700",children:[e.jsx(N,{className:"w-4 h-4 mr-1"}),"Mark as Read"]})]})]})}),e.jsxs(c,{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(p,{className:"w-5 h-5 text-gray-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Email"}),e.jsx("p",{className:"font-medium",children:B.email})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(y,{className:"w-5 h-5 text-gray-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Phone"}),e.jsx("p",{className:"font-medium",children:B.contactNumber})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(f,{className:"w-5 h-5 text-gray-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Submitted"}),e.jsx("p",{className:"font-medium",children:z(B.createdAt)})]})]}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsx(m,{variant:B.read?"secondary":"default",children:B.read?"Read":"Unread"})})]}),B.address&&e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(b,{className:"w-5 h-5 text-gray-500 mt-1"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Address"}),e.jsx("p",{className:"font-medium",children:B.address})]})]}),B.questions&&e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Questions/Message"}),e.jsx("div",{className:"bg-gray-50 p-4 rounded-lg",children:e.jsx("p",{className:"text-gray-700 whitespace-pre-wrap",children:B.questions})})]})]})]}):e.jsx(l,{children:e.jsx(c,{className:"py-12",children:e.jsxs("div",{className:"text-center text-gray-500",children:[e.jsx(g,{className:"w-12 h-12 mx-auto mb-4 text-gray-300"}),e.jsx("p",{children:"Select an inquiry to view details"})]})})})})]})]})};export{v as AdminInquiries};
