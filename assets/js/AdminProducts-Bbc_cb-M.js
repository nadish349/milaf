import{j as e,f as s,e as t}from"./index-jHmpFEMT.js";import{r as a}from"./vendor-CyyySG0f.js";import{l as r,y as n}from"./firebase-rYhY7HPw.js";import{m as c,c as i,d as l,s as o,k as d,a as x}from"./milafcola-BJYXYRQ2.js";import"./ui-D10HkiTw.js";import"./router-Dpy7eVzN.js";const m=()=>{const[m,g]=a.useState([]),[u,p]=a.useState(!0),[h,f]=a.useState(null),[b,j]=a.useState(""),[y,v]=a.useState("all"),[S,N]=a.useState(new Set),[w,k]=a.useState({}),C={"Milaf Cola":c,"Choco Spread":i,"Date Spread":l,"Safawi Dates":o,"Khalas Dates":d,"Segai Dates":x},I=(e,s)=>({id:s,name:e.name,image:C[e.name]||c,price:e.price,casesInStock:e.casesInStock,casesPerCase:e.casesPerCase,totalUnits:e.totalUnits,status:e.status,category:e.category,description:e.description});a.useEffect(()=>{(async()=>{try{p(!0);const e=await s();if(e.length>0){const s=e.map((e,s)=>I(e,s+1));g(s)}else{g([{id:1,name:"Milaf Cola",image:c,price:4.99,casesInStock:150,casesPerCase:20,totalUnits:3e3,status:"In Stock",category:"Beverages",description:"Refreshing natural cola drink"},{id:2,name:"Choco Spread",image:i,price:6.99,casesInStock:75,casesPerCase:24,totalUnits:1800,status:"Low Stock",category:"Spreads",description:"Rich chocolate date spread"},{id:3,name:"Date Spread",image:l,price:7.99,casesInStock:200,casesPerCase:20,totalUnits:4e3,status:"In Stock",category:"Spreads",description:"Natural date spread"},{id:4,name:"Safawi Dates",image:o,price:8.99,casesInStock:0,casesPerCase:25,totalUnits:0,status:"Out of Stock",category:"Dates",description:"Premium quality dates"},{id:5,name:"Khalas Dates",image:d,price:9.99,casesInStock:120,casesPerCase:30,totalUnits:3600,status:"In Stock",category:"Dates",description:"Premium Khalas dates from Saudi Arabia"},{id:6,name:"Segai Dates",image:x,price:10.99,casesInStock:80,casesPerCase:25,totalUnits:2e3,status:"In Stock",category:"Dates",description:"High-quality Segai dates"}])}}catch(e){g([])}finally{p(!1)}})()},[]);const P=m.filter(e=>{const s=e.name.toLowerCase().includes(b.toLowerCase()),t="all"===y||e.category===y;return s&&t}),U=e=>{switch(e){case"In Stock":return"bg-green-100 text-green-800";case"Low Stock":return"bg-yellow-100 text-yellow-800";case"Out of Stock":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},D=async()=>{if(h){const a={...h,totalUnits:h.casesInStock*h.casesPerCase,status:0===h.casesInStock?"Out of Stock":h.casesInStock<=50?"Low Stock":"In Stock"};g(e=>e.map(e=>e.id===h.id?a:e));try{N(e=>new Set(e).add(h.id)),k(e=>({...e,[h.id]:null}));const e=r(t,"products",a.name),s={name:a.name,price:a.price,casesInStock:a.casesInStock,casesPerCase:a.casesPerCase,totalUnits:a.totalUnits,status:a.status,category:a.category,description:a.description,lastUpdated:(new Date).toISOString()};await n(e,s,{merge:!0}),k(e=>({...e,[h.id]:"success"})),setTimeout(()=>{k(e=>({...e,[h.id]:null}))},3e3)}catch(e){k(e=>({...e,[h.id]:"error"})),setTimeout(()=>{k(e=>({...e,[h.id]:null}))},5e3)}finally{N(e=>{const s=new Set(e);return s.delete(h.id),s})}f(null);setTimeout(async()=>{try{const e=await s();if(e.length>0){const s=e.map((e,s)=>I(e,s+1));g(s)}}catch(e){}},1e3)}},L=()=>{f(null)};return u?e.jsx("div",{className:"space-y-6",children:e.jsx("div",{className:"bg-white rounded-xl shadow-lg p-6",children:e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-500 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading products from database..."})]})})})}):e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-white rounded-xl shadow-lg p-6",children:e.jsx("div",{className:"flex justify-between items-center",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-2",children:"Products Management"}),e.jsx("p",{className:"text-gray-600",children:"Manage your product inventory and stock levels"})]})})}),e.jsx("div",{className:"bg-white rounded-xl shadow-lg p-6",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsx("input",{type:"text",placeholder:"Search products by name...",value:b,onChange:e=>j(e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"})}),e.jsx("div",{className:"flex-shrink-0",children:e.jsx("select",{value:y,onChange:e=>v(e.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",children:["all","Beverages","Spreads","Dates"].map(s=>e.jsx("option",{value:s,children:"all"===s?"All Categories":s},s))})})]})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:P.map(s=>e.jsxs("div",{className:"bg-white rounded-xl shadow-lg overflow-hidden",children:[e.jsx("div",{className:"h-48 bg-gray-100 flex items-center justify-center",children:e.jsx("img",{src:s.image,alt:s.name,className:"h-full w-full object-contain p-4"})}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[h?.id===s.id?e.jsx("input",{type:"text",value:h.name,onChange:e=>f({...h,name:e.target.value}),className:"text-lg font-bold text-gray-800 bg-transparent border-b border-gray-300 focus:border-green-500 focus:outline-none flex-1 mr-2"}):e.jsx("h3",{className:"text-lg font-bold text-gray-800",children:s.name}),e.jsx("span",{className:`inline-block px-2 py-1 rounded-full text-xs font-medium ${U(s.status)}`,children:s.status})]}),h?.id===s.id?e.jsx("textarea",{value:h.description,onChange:e=>f({...h,description:e.target.value}),className:"w-full text-sm text-gray-600 mb-3 p-2 border border-gray-300 rounded focus:ring-2 focus:ring-green-500 focus:border-transparent resize-none",rows:2}):e.jsx("p",{className:"text-sm text-gray-600 mb-3",children:s.description}),e.jsxs("div",{className:"space-y-2 mb-4",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Price:"}),h?.id===s.id?e.jsx("input",{type:"number",step:"0.01",min:"0",value:h.price,onChange:e=>f({...h,price:parseFloat(e.target.value)||0}),className:"w-20 px-2 py-1 border border-gray-300 rounded text-sm focus:ring-2 focus:ring-green-500 focus:border-transparent"}):e.jsxs("span",{className:"font-semibold",children:["$",s.price]})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Category:"}),h?.id===s.id?e.jsxs("select",{value:h.category,onChange:e=>f({...h,category:e.target.value}),className:"px-2 py-1 border border-gray-300 rounded text-sm focus:ring-2 focus:ring-green-500 focus:border-transparent",children:[e.jsx("option",{value:"Beverages",children:"Beverages"}),e.jsx("option",{value:"Spreads",children:"Spreads"}),e.jsx("option",{value:"Dates",children:"Dates"})]}):e.jsx("span",{className:"font-semibold",children:s.category})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Units per Case:"}),h?.id===s.id?e.jsx("input",{type:"number",min:"1",value:h.casesPerCase,onChange:e=>f({...h,casesPerCase:parseInt(e.target.value)||1}),className:"w-20 px-2 py-1 border border-gray-300 rounded text-sm focus:ring-2 focus:ring-green-500 focus:border-transparent"}):e.jsx("span",{className:"font-semibold",children:s.casesPerCase})]})]}),e.jsxs("div",{className:"border-t border-gray-200 pt-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Cases in Stock:"}),e.jsx("span",{className:"text-lg font-bold text-gray-900",children:s.casesInStock})]}),e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Total Units:"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:s.totalUnits})]}),e.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[e.jsx("input",{type:"number",min:"0",value:h?.id===s.id?h.casesInStock:s.casesInStock,onChange:e=>{h?.id===s.id&&f({...h,casesInStock:parseInt(e.target.value)||0})},className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"Update cases"}),e.jsx("span",{className:"text-xs text-gray-500",children:"cases"})]}),e.jsx("div",{className:"flex space-x-2",children:h?.id===s.id?e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:D,disabled:S.has(s.id),className:"flex-1 text-white text-sm py-2 px-3 rounded-lg transition-colors "+("success"===w[s.id]?"bg-green-600":"error"===w[s.id]?"bg-red-500":"bg-green-500 hover:bg-green-600 disabled:bg-green-300"),children:S.has(s.id)?"Saving...":"success"===w[s.id]?"✅ Saved!":"error"===w[s.id]?"❌ Error":"Save"}),e.jsx("button",{onClick:L,disabled:S.has(s.id),className:"flex-1 bg-gray-500 hover:bg-gray-600 disabled:bg-gray-300 text-white text-sm py-2 px-3 rounded-lg transition-colors",children:"Cancel"})]}):e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>(e=>{f({...e})})(s),className:"flex-1 bg-blue-500 hover:bg-blue-600 text-white text-sm py-2 px-3 rounded-lg transition-colors",children:"Edit Product"}),e.jsx("button",{onClick:()=>{return e=s.id,t=s.casesInStock+10,void g(s=>s.map(s=>{if(s.id===e){const e=t*s.casesPerCase;let a;return a=0===t?"Out of Stock":t<=50?"Low Stock":"In Stock",{...s,casesInStock:t,totalUnits:e,status:a}}return s}));var e,t},className:"flex-1 bg-green-500 hover:bg-green-600 text-white text-sm py-2 px-3 rounded-lg transition-colors",children:"+10 Cases"})]})})]})]})]},s.id))}),e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-800 mb-4",children:"Stock Summary"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"text-center p-4 bg-green-50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:m.filter(e=>"In Stock"===e.status).length}),e.jsx("div",{className:"text-sm text-green-600",children:"In Stock"})]}),e.jsxs("div",{className:"text-center p-4 bg-yellow-50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:m.filter(e=>"Low Stock"===e.status).length}),e.jsx("div",{className:"text-sm text-yellow-600",children:"Low Stock"})]}),e.jsxs("div",{className:"text-center p-4 bg-red-50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-red-600",children:m.filter(e=>"Out of Stock"===e.status).length}),e.jsx("div",{className:"text-sm text-red-600",children:"Out of Stock"})]}),e.jsxs("div",{className:"text-center p-4 bg-blue-50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:m.reduce((e,s)=>e+s.totalUnits,0).toLocaleString()}),e.jsx("div",{className:"text-sm text-blue-600",children:"Total Units"})]})]})]})]})};export{m as AdminProducts};
